[gd_scene load_steps=21 format=3 uid="uid://cymafpdprn0cn"]

[ext_resource type="Script" uid="uid://k72dmo2yqq6n" path="res://Scripts/Classes/LevelClass.gd" id="1_66414"]
[ext_resource type="AudioStream" uid="uid://d2mfwfapwilqw" path="res://Resources/MusicTracks/GhostHouse.tres" id="2_dbsph"]
[ext_resource type="PackedScene" uid="uid://c1xol3wby2j0k" path="res://Instances/Prefabs/level_bg.tscn" id="2_hl31k"]
[ext_resource type="Texture2D" uid="uid://bnonaxe38cbgq" path="res://Assets/Sprites/Backgrounds/Underwater/BG1.png" id="4_q4rax"]
[ext_resource type="PackedScene" uid="uid://cqw1qs0bt5s4o" path="res://Instances/Prefabs/Player.tscn" id="5_r0usw"]
[ext_resource type="Texture2D" uid="uid://cy2004wm28cuq" path="res://Assets/Sprites/Backgrounds/GhostHouse/Clouds2.png" id="5_vh1ib"]
[ext_resource type="PackedScene" uid="uid://dwavjbyw0v12l" path="res://Instances/Prefabs/tile_map.tscn" id="7_mtacf"]
[ext_resource type="PackedScene" uid="uid://bw8btch38g6bx" path="res://Instances/Prefabs/Interactables/water.tscn" id="11_xjikn"]
[ext_resource type="PackedScene" uid="uid://2n65pmkmpmp3" path="res://Instances/Prefabs/Interactables/bullet_bill_launcher.tscn" id="13_a2ois"]
[ext_resource type="PackedScene" uid="uid://3dbp1bh377er" path="res://Instances/Prefabs/Blocks/question_block.tscn" id="14_oc5nu"]
[ext_resource type="PackedScene" uid="uid://cdbsvmplutv35" path="res://Instances/Prefabs/Items/cape_feather.tscn" id="15_p30kk"]
[ext_resource type="PackedScene" uid="uid://cly5f6jt1cd28" path="res://Instances/Prefabs/Interactables/pipe_area.tscn" id="17_j7vg6"]

[sub_resource type="AtlasTexture" id="AtlasTexture_8h32w"]
atlas = ExtResource("4_q4rax")
region = Rect2(0, 0, 512, 432)

[sub_resource type="AtlasTexture" id="AtlasTexture_tf3av"]
atlas = ExtResource("4_q4rax")
region = Rect2(512, 0, 512, 432)

[sub_resource type="AtlasTexture" id="AtlasTexture_i7d1x"]
atlas = ExtResource("4_q4rax")
region = Rect2(1024, 0, 512, 432)

[sub_resource type="AtlasTexture" id="AtlasTexture_2mysf"]
atlas = ExtResource("4_q4rax")
region = Rect2(1536, 0, 512, 432)

[sub_resource type="SpriteFrames" id="SpriteFrames_s46n6"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_8h32w")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tf3av")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_i7d1x")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2mysf")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="Shader" id="Shader_1xk88"]
code = "// HSV to RBG from https://www.rapidtables.com/convert/color/hsv-to-rgb.html
// Rotation matrix from https://en.wikipedia.org/wiki/Rotation_matrix

shader_type canvas_item;


uniform float strength: hint_range(0., 1.) = 0.5;
uniform float speed: hint_range(0., 10.) = 0.5;
uniform float angle: hint_range(0., 360.) = 0.;

void fragment() {
	float hue = UV.x * cos(radians(angle)) - UV.y * sin(radians(angle));
	hue = fract(hue + fract(TIME  * speed));
	float x = 1. - abs(mod(hue / (1./ 6.), 2.) - 1.);
	vec3 rainbow;
	if(hue < 1./6.){
		rainbow = vec3(1., x, 0.);
	} else if (hue < 1./3.) {
		rainbow = vec3(x, 1., 0);
	} else if (hue < 0.5) {
		rainbow = vec3(0, 1., x);
	} else if (hue < 2./3.) {
		rainbow = vec3(0., x, 1.);
	} else if (hue < 5./6.) {
		rainbow = vec3(x, 0., 1.);
	} else {
		rainbow = vec3(1., 0., x);
	}
	vec4 color = texture(TEXTURE, UV);
	COLOR = mix(color, vec4(rainbow, color.a), strength);
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_krt8h"]
resource_local_to_scene = true
shader = SubResource("Shader_1xk88")
shader_parameter/strength = 0.0
shader_parameter/speed = 0.5
shader_parameter/angle = 36.404

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ohrwl"]
resource_local_to_scene = true
size = Vector2(3800, 1984)

[node name="GhostShip1" type="Node"]
script = ExtResource("1_66414")
level_music = ExtResource("2_dbsph")
camera_left_end_position = 704
camera_top_end_position = -384

[node name="LevelBG" parent="." instance=ExtResource("2_hl31k")]
main_sprite_frames = SubResource("SpriteFrames_s46n6")
fg_texture = ExtResource("5_vh1ib")
sky_colour = Color(0, 0, 0, 1)
fg_scroll_speed = Vector2(-16, 0)
fg_vertical_offset = -384

[node name="Player" parent="." instance=ExtResource("5_r0usw")]
material = SubResource("ShaderMaterial_krt8h")
position = Vector2(-8, -144)

[node name="TileMap" parent="." instance=ExtResource("7_mtacf")]
layer_0/tile_data = PackedInt32Array(-524291, 327700, 5, -589819, 458772, 5, -524275, 458772, 5, -458737, 458772, 5, -393197, 458772, 5, -262125, 458772, 5, -131053, 458772, 5, 19, 458772, 5, 131091, 458772, 5, 65558, 458772, 5, -65514, 458772, 5, -196586, 458772, 5, -327658, 458772, 5, -393181, 458772, 5, -262109, 458772, 5, -131037, 458772, 5, 35, 458772, 5, 131107, 458772, 5, 65574, 458772, 5, -65498, 458772, 5, -196570, 458772, 5, -327642, 458772, 5, -393173, 458772, 5, -327637, 458772, 5, -262101, 458772, 5, -196565, 458772, 5, -131029, 458772, 5, -65493, 458772, 5, 43, 458772, 5, 65579, 458772, 5, 131115, 458772, 5, 131108, 327700, 5, 36, 327700, 5, -131036, 327700, 5, -262108, 327700, 5, -393180, 327700, 5, -327641, 327700, 5, -196569, 327700, 5, -65497, 327700, 5, 65575, 327700, 5, 131092, 327700, 5, 20, 327700, 5, -131052, 327700, 5, -262124, 327700, 5, -393196, 327700, 5, -327657, 327700, 5, -196585, 327700, 5, -65513, 327700, 5, 65559, 327700, 5, 131087, 327700, 5, 65551, 327700, 5, 14, 327700, 5, -65523, 327700, 5, -131060, 327700, 5, -196597, 327700, 5, -262135, 327700, 5, -327673, 327700, 5, -393211, 327700, 5, -458749, 327700, 5, -524287, 327700, 5, -524290, 393236, 5, -524289, 393236, 5, -589824, 393236, 5, -589823, 393236, 5, -589822, 393236, 5, -524285, 393236, 5, -524284, 393236, 5, -589820, 393236, 5, -589821, 393236, 5, -524286, 393236, 5, -524283, 393236, 5, -524282, 393236, 5, -524281, 393236, 5, -524280, 393236, 5, -524279, 393236, 5, -524278, 393236, 5, -524277, 393236, 5, -524276, 393236, 5, -458740, 393236, 5, -458741, 393236, 5, -458742, 393236, 5, -458743, 393236, 5, -458744, 393236, 5, -458745, 393236, 5, -458746, 393236, 5, -458747, 393236, 5, -458748, 393236, 5, -393210, 393236, 5, -393209, 393236, 5, -393208, 393236, 5, -393207, 393236, 5, -393206, 393236, 5, -393205, 393236, 5, -393204, 393236, 5, -458739, 393236, 5, -458738, 393236, 5, -393202, 393236, 5, -393203, 393236, 5, -327672, 393236, 5, -327671, 393236, 5, -327670, 393236, 5, -327669, 393236, 5, -327668, 393236, 5, -327667, 393236, 5, -327666, 393236, 5, -262134, 393236, 5, -262133, 393236, 5, -262132, 393236, 5, -262131, 393236, 5, -262130, 393236, 5, -262129, 393236, 5, -262128, 393236, 5, -262127, 393236, 5, -262126, 393236, 5, -393201, 393236, 5, -327665, 393236, 5, -393200, 393236, 5, -327664, 393236, 5, -393199, 393236, 5, -327663, 393236, 5, -393198, 393236, 5, -327662, 393236, 5, -327661, 393236, 5, -327660, 393236, 5, -393195, 393236, 5, -327659, 393236, 5, -262123, 393236, 5, -196587, 393236, 5, -131051, 393236, 5, -65515, 393236, 5, 21, 393236, 5, 65557, 393236, 5, -196596, 393236, 5, -196595, 393236, 5, -196594, 393236, 5, -196593, 393236, 5, -196592, 393236, 5, -196591, 393236, 5, -196590, 393236, 5, -196589, 393236, 5, -196588, 393236, 5, -131059, 393236, 5, -131058, 393236, 5, -131057, 393236, 5, -131056, 393236, 5, -131055, 393236, 5, -131054, 393236, 5, -65522, 393236, 5, -65521, 393236, 5, -65520, 393236, 5, -65519, 393236, 5, -65518, 393236, 5, 15, 393236, 5, 16, 393236, 5, 17, 393236, 5, 18, 393236, 5, 65552, 393236, 5, 131088, 393236, 5, 65553, 393236, 5, 131089, 393236, 5, 65554, 393236, 5, 131090, 393236, 5, 65555, 393236, 5, 65556, 393236, 5, 131093, 393236, 5, 131094, 393236, 5, 131095, 393236, 5, 22, 393236, 5, 23, 393236, 5, -65517, 393236, 5, -65516, 393236, 5, -131050, 393236, 5, -131049, 393236, 5, -262122, 393236, 5, -262121, 393236, 5, -393194, 393236, 5, -393193, 393236, 5, -393192, 393236, 5, -327656, 393236, 5, -262120, 393236, 5, -196584, 393236, 5, -131048, 393236, 5, -65512, 393236, 5, 24, 393236, 5, 65560, 393236, 5, 131096, 393236, 5, -393191, 393236, 5, -327655, 393236, 5, -262119, 393236, 5, -196583, 393236, 5, -131047, 393236, 5, -65511, 393236, 5, 25, 393236, 5, 65561, 393236, 5, 131097, 393236, 5, -393190, 393236, 5, -327654, 393236, 5, -262118, 393236, 5, -196582, 393236, 5, -131046, 393236, 5, -65510, 393236, 5, 26, 393236, 5, 65562, 393236, 5, 131098, 393236, 5, -393189, 393236, 5, -327653, 393236, 5, -262117, 393236, 5, -196581, 393236, 5, -131045, 393236, 5, -65509, 393236, 5, 27, 393236, 5, 65563, 393236, 5, 131099, 393236, 5, -393188, 393236, 5, -327652, 393236, 5, -262116, 393236, 5, -196580, 393236, 5, -131044, 393236, 5, -65508, 393236, 5, 28, 393236, 5, 65564, 393236, 5, 131100, 393236, 5, -393187, 393236, 5, -327651, 393236, 5, -262115, 393236, 5, -196579, 393236, 5, -131043, 393236, 5, -65507, 393236, 5, 29, 393236, 5, 65565, 393236, 5, 131101, 393236, 5, -393186, 393236, 5, -327650, 393236, 5, -262114, 393236, 5, -196578, 393236, 5, -131042, 393236, 5, -65506, 393236, 5, 30, 393236, 5, 65566, 393236, 5, 131102, 393236, 5, -393185, 393236, 5, -327649, 393236, 5, -262113, 393236, 5, -196577, 393236, 5, -131041, 393236, 5, -65505, 393236, 5, 31, 393236, 5, 65567, 393236, 5, 131103, 393236, 5, -393184, 393236, 5, -327648, 393236, 5, -262112, 393236, 5, -196576, 393236, 5, -131040, 393236, 5, -65504, 393236, 5, 32, 393236, 5, 65568, 393236, 5, 131104, 393236, 5, -393183, 393236, 5, -327647, 393236, 5, -262111, 393236, 5, -196575, 393236, 5, -131039, 393236, 5, -65503, 393236, 5, 33, 393236, 5, 65569, 393236, 5, 131105, 393236, 5, -393182, 393236, 5, -327646, 393236, 5, -262110, 393236, 5, -196574, 393236, 5, -131038, 393236, 5, -65502, 393236, 5, 34, 393236, 5, 65570, 393236, 5, 131106, 393236, 5, -327645, 393236, 5, -327644, 393236, 5, -327643, 393236, 5, -196573, 393236, 5, -196572, 393236, 5, -196571, 393236, 5, -65501, 393236, 5, -65500, 393236, 5, -65499, 393236, 5, 65571, 393236, 5, 65572, 393236, 5, 65573, 393236, 5, 37, 393236, 5, 38, 393236, 5, 39, 393236, 5, 131109, 393236, 5, 131110, 393236, 5, 131111, 393236, 5, -131035, 393236, 5, -131034, 393236, 5, -131033, 393236, 5, -262107, 393236, 5, -262106, 393236, 5, -262105, 393236, 5, -393179, 393236, 5, -393178, 393236, 5, -393177, 393236, 5, -393176, 393236, 5, -327640, 393236, 5, -262104, 393236, 5, -196568, 393236, 5, -131032, 393236, 5, -65496, 393236, 5, 40, 393236, 5, 65576, 393236, 5, 131112, 393236, 5, -393175, 393236, 5, -327639, 393236, 5, -262103, 393236, 5, -196567, 393236, 5, -131031, 393236, 5, -65495, 393236, 5, 41, 393236, 5, 65577, 393236, 5, 131113, 393236, 5, -393174, 393236, 5, -327638, 393236, 5, -262102, 393236, 5, -196566, 393236, 5, -131030, 393236, 5, -65494, 393236, 5, 42, 393236, 5, 65578, 393236, 5, 131114, 393236, 5, -1310689, 131083, 1, -1245153, 131083, 1, -1179617, 131083, 1, -1114081, 131083, 1, -1310688, 131083, 1, -1245152, 131083, 1, -1179616, 131083, 1, -1114080, 131083, 1, -1310687, 131083, 1, -1245151, 131083, 1, -1179615, 131083, 1, -1114079, 131083, 1, -1310686, 131083, 1, -1245150, 131083, 1, -1179614, 131083, 1, -1114078, 131083, 1, -1310685, 131083, 1, -1245149, 131083, 1, -1179613, 131083, 1, -1114077, 131083, 1, -1310684, 131083, 1, -1245148, 131083, 1, -1179612, 131083, 1, -1114076, 131083, 1, -1310683, 131083, 1, -1245147, 131083, 1, -1179611, 131083, 1, -1114075, 131083, 1, -1310682, 131083, 1, -1245146, 131083, 1, -1179610, 131083, 1, -1114074, 131083, 1, -1310681, 131083, 1, -1245145, 131083, 1, -1179609, 131083, 1, -1114073, 131083, 1, -1310680, 131083, 1, -1245144, 131083, 1, -1179608, 131083, 1, -1114072, 131083, 1, -1310679, 131083, 1, -1245143, 131083, 1, -1179607, 131083, 1, -1114071, 131083, 1, -1310678, 131083, 1, -1245142, 131083, 1, -1179606, 131083, 1, -1114070, 131083, 1, -1310677, 131083, 1, -1245141, 131083, 1, -1179605, 131083, 1, -1114069, 131083, 1, -1048535, 131083, 1, -982999, 131083, 1, -917463, 131083, 1, -851927, 131083, 1, -786391, 131083, 1, -720855, 131083, 1, -655319, 131083, 1, -589783, 131083, 1, -1048534, 131083, 1, -982998, 131083, 1, -917462, 131083, 1, -851926, 131083, 1, -786390, 131083, 1, -720854, 131083, 1, -655318, 131083, 1, -589782, 131083, 1, -1048533, 131083, 1, -982997, 131083, 1, -917461, 131083, 1, -851925, 131083, 1, -786389, 131083, 1, -720853, 131083, 1, -655317, 131083, 1, -589781, 131083, 1, -524261, 65547, 0, -524260, 65547, 0, -524259, 65547, 0, -524258, 65547, 0, -524257, 65547, 0, -524256, 65547, 0, -524255, 65547, 0, -524254, 65547, 0, -524253, 65547, 0, -524252, 65547, 0, -524251, 65547, 0, -524250, 65547, 0, -524249, 65547, 0, -524248, 65547, 0, -524247, 65547, 0, -524246, 65547, 0, -524273, 65547, 0, -524272, 65547, 0, -524271, 65547, 0, -524270, 65547, 0, -524269, 65547, 0, -524268, 65547, 0, -524267, 65547, 0, -524266, 65547, 0, -524265, 65547, 0, -524264, 65547, 0, -524263, 65547, 0, -524262, 65547, 0, -524274, 11, 0, -458736, 11, 0, -458735, 65547, 0, -458734, 65547, 0, -458733, 65547, 0, -458732, 65547, 0, -458731, 65547, 0, -458730, 65547, 0, -458729, 65547, 0, -458728, 65547, 0, -458727, 65547, 0, -458726, 65547, 0, -458725, 65547, 0, -458724, 65547, 0, -458723, 65547, 0, -458722, 65547, 0, -458721, 65547, 0, -458720, 65547, 0, -458719, 65547, 0, -458718, 65547, 0, -458717, 65547, 0, -458716, 65547, 0, -458715, 65547, 0, -458714, 65547, 0, -458713, 65547, 0, -458712, 65547, 0, -458711, 65547, 0, -458710, 65547, 0, -524245, 131083, 0, -458709, 131083, 0, -589793, 131083, 1, -589792, 131083, 1, -589791, 131083, 1, -589790, 131083, 1, -589789, 131083, 1, -589788, 131083, 1, -589787, 131083, 1, -589786, 131083, 1, -1376224, 196619, 2, -1376223, 196619, 2, -1376222, 196619, 2, -1376221, 196619, 2, -1376220, 196619, 2, -1376219, 196619, 2, -1376218, 196619, 2, -1376217, 196619, 2, -1441761, 11, 2, -1441760, 65547, 2, -1441754, 65547, 2, -1441753, 131083, 2, -1441759, 65547, 2, -1441758, 65547, 2, -1441757, 65547, 2, -1441756, 65547, 2, -1441755, 65547, 2, -720878, 22, 0, -655342, 22, 1, -589806, 22, 1, -786393, 5, 4, -720857, 5, 5, -655321, 5, 5, -655320, 65541, 5, -589785, 5, 5, -589784, 65541, 5, -786392, 65541, 4, -720856, 65541, 5, -1245187, 131077, 8, -1245186, 196613, 8, -1507331, 5, 9, -1507330, 65541, 9, -1441795, 5, 9, -1441794, 65541, 9, -1376259, 5, 9, -1376258, 65541, 9, -1310723, 5, 9, -1310722, 65541, 9)
layer_1/tile_data = PackedInt32Array(-1048540, 327691, 0, -983004, 327691, 1, -917468, 327691, 1, -851932, 327691, 1, -786396, 327691, 1, -720860, 327691, 1, -655324, 327691, 1, -851956, 11, 3, -786420, 11, 4, -720884, 11, 5, -655348, 11, 4, -589812, 11, 6, -851955, 65547, 3, -786419, 65547, 4, -720883, 65547, 5, -655347, 65547, 4, -589811, 65547, 6, -851954, 65547, 3, -786418, 65547, 4, -720882, 65547, 5, -655346, 65547, 4, -589810, 65547, 6, -1179633, 11, 3, -1114097, 11, 4, -1048561, 11, 5, -983025, 11, 4, -917489, 11, 6, -851953, 131083, 3, -786417, 131083, 4, -720881, 131083, 5, -655345, 131083, 4, -589809, 131083, 6, -1179632, 65547, 3, -1114096, 65547, 4, -1048560, 65547, 5, -983024, 65547, 4, -917488, 65547, 6, -1179631, 65547, 3, -1114095, 65547, 4, -1048559, 65547, 5, -983023, 65547, 4, -917487, 65547, 6, -1179630, 65547, 3, -1114094, 65547, 4, -1048558, 65547, 5, -983022, 65547, 4, -917486, 65547, 6, -1179629, 65547, 3, -1114093, 65547, 4, -1048557, 65547, 5, -983021, 65547, 4, -917485, 65547, 6, -1179628, 65547, 3, -1114092, 65547, 4, -1048556, 65547, 5, -983020, 65547, 4, -917484, 65547, 6, -1179627, 131083, 3, -1114091, 131083, 4, -1048555, 131083, 5, -983019, 131083, 4, -917483, 131083, 6, -851947, 11, 3, -786411, 11, 4, -720875, 11, 5, -655339, 11, 4, -589803, 11, 6, -851946, 65547, 3, -786410, 65547, 4, -720874, 65547, 5, -655338, 65547, 4, -589802, 65547, 6, -1048553, 11, 3, -983017, 11, 4, -917481, 11, 6, -851945, 65547, 3, -786409, 65547, 4, -720873, 65547, 5, -655337, 65547, 4, -589801, 65547, 6, -1048552, 65547, 3, -983016, 65547, 4, -917480, 65547, 6, -851944, 131083, 3, -786408, 131083, 4, -720872, 131083, 5, -655336, 131083, 4, -589800, 131083, 6, -1048551, 65547, 3, -983015, 65547, 4, -917479, 65547, 6, -1048550, 131083, 3, -983014, 131083, 4, -917478, 131083, 6, -917469, 393227, 0, -983006, 393227, 0, -983005, 458763, 0, -1048543, 393227, 0, -1048542, 458763, 0, -983002, 393227, 268435456, -983003, 458763, 268435456, -1048537, 393227, 268435456, -1048538, 458763, 268435456, -917467, 393227, 268435456, -1572823, 327691, 0, -1507287, 327691, 1, -1441751, 327691, 1, -1376215, 327691, 1, -655362, 11, 2, -655361, 65547, 2, -720892, 65547, 2, -720891, 131083, 2, -720896, 65547, 2, -720895, 65547, 2, -720894, 65547, 2, -720893, 65547, 2, -589825, 196619, 2, -655360, 196619, 2, -655359, 196619, 2, -655358, 196619, 2, -655357, 196619, 2, -655356, 196619, 2, -655355, 196619, 2)

[node name="LevelGuide" type="Sprite2D" parent="."]
modulate = Color(0.411765, 0.411765, 0.411765, 1)
z_index = -10
position = Vector2(-64, -384)
centered = false

[node name="Water" parent="." instance=ExtResource("11_xjikn")]
position = Vector2(660, -224)
shape = SubResource("RectangleShape2D_ohrwl")

[node name="BulletBillLauncher" parent="." instance=ExtResource("13_a2ois")]
position = Vector2(296, -184)

[node name="BulletBillLauncher2" parent="." instance=ExtResource("13_a2ois")]
position = Vector2(216, -216)

[node name="BulletBillLauncher3" parent="." instance=ExtResource("13_a2ois")]
position = Vector2(328, -296)

[node name="BulletBillLauncher4" parent="." instance=ExtResource("13_a2ois")]
position = Vector2(504, -152)

[node name="?Block" parent="." instance=ExtResource("14_oc5nu")]
position = Vector2(216, -264)
item = ExtResource("15_p30kk")

[node name="PipeArea" parent="." instance=ExtResource("17_j7vg6")]
position = Vector2(-32, -304)
enter_direction = "Up"
auto_exit = true
exit_only = true

[node name="PipeArea2" parent="." instance=ExtResource("17_j7vg6")]
position = Vector2(640, -192)
level_scene = "res://Instances/Levels/BowserValley/gs_2.tscn"
pipe_id = 1
